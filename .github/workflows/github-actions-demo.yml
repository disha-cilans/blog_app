name: GitHub Actions Demo
on: 
  push:
    branches:
      - dev
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - run: echo "🎉 The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo "🐧 This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo "🔎 The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Check out repository code
        uses: actions/checkout@v3
      - run: echo "💡 The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo "🖥️ The workflow is now ready to test your code on the runner."
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - run: echo "🍏 This job's status is ${{ job.status }}."

# name: Deploy to IBM Cloud 
#  on: 
#    pull_request: 
#      branches: 
#        - staging 
#      types: [closed] 
#  jobs: 
#    merge_job: 
#      # this job will only run if the PR has been merged 
#      if: github.event.pull_request.merged == true  
#      runs-on: ubuntu-latest 
#      steps: 
#        - name: GitHub VM - SSH Connection 
#          uses: appleboy/ssh-action@master 
#          with: 
#            host : ${{ secrets.SSH_HOST }} 
#            username : root 
#            key: ${{ secrets.SSH_SECRET }} 
#            port : 22 
#            script : | 
#              echo 'IBM - Changing directory...' 
#              cd /root/staging/tensorplace-backend 
#              echo 'IBM - Pull the latest changes from Github...' 
#              git fetch --all 
#              git pull origin staging 
#              echo 'IBM - Installing Dependencies' 
#              npm install 
#              echo 'IBM - Creating version.js ...' 
#              bash ./create_version_file.sh 
#              echo 'IBM - Restarting the Staging Backend service...' 
#              systemctl restart tensorplace_back_staging.service 
#    close_job: 
#      # this job will only run if the PR has been closed without being merged 
#      if: github.event.pull_request.merged == false 
#      runs-on: ubuntu-latest 
#      steps: 
#      - run: | 
#          echo PR #${{ github.event.number }} has been closed without being merged